<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Study Buddy</title>
<style>
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
  background: linear-gradient(135deg, #e0f7fa, #ffe0b2);
  color: #333;
}

.container {
  max-width: 800px;
  margin: 20px auto;
  padding: 20px;
  background: white;
  border-radius: 15px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.2);
}

h1, h2 {
  text-align: center;
  color: #00796b;
}

input[type="text"], select, textarea {
  width: 100%;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 16px;
}

button {
  background-color: #00796b;
  color: white;
  border: none;
  padding: 10px 20px;
  margin: 5px 0;
  border-radius: 8px;
  cursor: pointer;
  font-size: 16px;
  transition: background 0.3s;
}

button:hover {
  background-color: #004d40;
}

.flashcard {
  margin-top: 15px;
  background-color: #fff3e0;
  padding: 25px;
  border-radius: 12px;
  text-align: center;
  font-size: 20px;
  font-weight: bold;
  min-height: 80px;
  cursor: pointer;
  perspective: 1000px;
  transition: transform 0.6s;
}

.flashcard.flip {
  transform: rotateY(180deg);
}

.quiz-option {
  display: block;
  width: 100%;
  margin: 5px 0;
  padding: 10px;
  background-color: #b2ebf2;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.3s;
  text-align: left;
}

.quiz-option:hover {
  background-color: #80deea;
}

.section {
  margin-bottom: 30px;
}
</style>
</head>
<body>
<div class="container">
  <h1>Smart Study Buddy üìò‚ú®</h1>

  <!-- Add Notes -->
  <div class="section">
    <h2>Add Notes</h2>
    <input type="text" id="subjectInput" placeholder="Subject (Math, Biology, etc.)">
    <textarea id="noteInput" placeholder="Type a note here or upload a file"></textarea>
    <input type="file" id="fileInput" accept=".txt">
    <button onclick="addNote()">Add Note</button>
  </div>

  <!-- Flashcards -->
  <div class="section">
    <h2>Flashcards</h2>
    <select id="subjectFilter" onchange="filterFlashcards()">
      <option value="All">All Subjects</option>
    </select>
    <button onclick="showFlashcard()">Show Flashcard</button>
    <div id="flashcard" class="flashcard"></div>
    <button onclick="flipFlashcard()">Flip Card</button>
  </div>

  <!-- Quiz -->
  <div class="section">
    <h2>Multiple-Choice Quiz</h2>
    <select id="quizSubjectFilter">
      <option value="All">All Subjects</option>
    </select>
    <button onclick="startQuiz()">Start Quiz</button>
    <p id="quizQuestion"></p>
    <div id="quizOptions"></div>
    <p id="quizResult"></p>
  </div>
</div>

<script>
let notes = JSON.parse(localStorage.getItem("notes")) || [];
let flashcards = [];
let filteredFlashcards = [];
let currentFlashcardIndex = 0;
let quizData = [];
let currentQuiz = null;

// Subject filters
function updateSubjectFilters() {
  const subjectSet = new Set(notes.map(n => n.subject));
  const flashFilter = document.getElementById("subjectFilter");
  const quizFilter = document.getElementById("quizSubjectFilter");

  [flashFilter, quizFilter].forEach(filter => {
    filter.innerHTML = '<option value="All">All Subjects</option>';
    subjectSet.forEach(subj => {
      const opt = document.createElement("option");
      opt.value = subj;
      opt.textContent = subj;
      filter.appendChild(opt);
    });
  });
}

// Add note
function addNote() {
  const noteText = document.getElementById("noteInput").value.trim();
  const subject = document.getElementById("subjectInput").value.trim() || "General";
  const fileInput = document.getElementById("fileInput");

  if (fileInput.files.length > 0) {
    const file = fileInput.files[0];
    const reader = new FileReader();
    reader.onload = function(e) {
      const fileText = e.target.result;
      const lines = fileText.split(/\r?\n/).filter(Boolean);
      lines.forEach(line => notes.push({text: line, subject}));
      localStorage.setItem("notes", JSON.stringify(notes));
      createFlashcards();
      updateSubjectFilters();
    };
    reader.readAsText(file);
    fileInput.value = "";
  }

  if (noteText) {
    notes.push({text: noteText, subject});
    localStorage.setItem("notes", JSON.stringify(notes));
    document.getElementById("noteInput").value = "";
    createFlashcards();
    updateSubjectFilters();
  }
}

// Create flashcards
function createFlashcards() {
  flashcards = notes.flatMap(note => {
    const sentences = note.text.split(/[\.\?!]/).filter(Boolean);
    return sentences.map(s => ({
      question: s.trim() + "?",
      answer: note.text.trim(),
      subject: note.subject
    }));
  });
}

// Show flashcard
function showFlashcard() {
  const subject = document.getElementById("subjectFilter").value;
  filteredFlashcards = subject === "All" ? flashcards : flashcards.filter(f => f.subject === subject);
  if (filteredFlashcards.length === 0) return alert("No flashcards for this subject!");
  currentFlashcardIndex = Math.floor(Math.random() * filteredFlashcards.length);
  const card = document.getElementById("flashcard");
  card.textContent = filteredFlashcards[currentFlashcardIndex].question;
  card.classList.remove("flip");
}

// Flip flashcard
function flipFlashcard() {
  const card = document.getElementById("flashcard");
  const flash = filteredFlashcards[currentFlashcardIndex];
  if (!flash) return;
  card.classList.toggle("flip");
  card.textContent = card.textContent === flash.question ? flash.answer : flash.question;
}

// Quiz
function startQuiz() {
  const subject = document.getElementById("quizSubjectFilter").value;
  quizData = subject === "All" ? flashcards : flashcards.filter(f => f.subject === subject);
  if (quizData.length === 0) return alert("No quiz questions for this subject!");

  currentQuiz = quizData[Math.floor(Math.random() * quizData.length)];
  document.getElementById("quizQuestion").textContent = currentQuiz.question;

  const optionsContainer = document.getElementById("quizOptions");
  optionsContainer.innerHTML = "";
  const answers = [currentQuiz.answer];
  while (answers.length < Math.min(4, quizData.length)) {
    const randAnswer = quizData[Math.floor(Math.random() * quizData.length)].answer;
    if (!answers.includes(randAnswer)) answers.push(randAnswer);
  }
  answers.sort(() => Math.random() - 0.5);
  answers.forEach(ans => {
    const btn = document.createElement("button");
    btn.className = "quiz-option";
    btn.textContent = ans;
    btn.onclick = () => checkQuizAnswer(ans);
    optionsContainer.appendChild(btn);
  });
  document.getElementById("quizResult").textContent = "";
}

function checkQuizAnswer(selected) {
  const result = document.getElementById("quizResult");
  if (selected === currentQuiz.answer) {
    result.textContent = "‚úÖ Correct!";
  } else {
    result.textContent = "‚ùå Wrong. Correct answer: " + currentQuiz.answer;
  }
}

// Initialize
createFlashcards();
updateSubjectFilters();
</script>
</body>
</html>
